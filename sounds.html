<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Volume + PCM</title>
<script src="https://dropbox.inf.re/webos-gfn/client.js"></script>
<script src="https://dropbox.inf.re/webos-gfn/wsproxy.js"></script>

<style>
body{margin:10px;font-family:Arial,sans-serif;background:#0b0b0b;color:#fff;}
.btn{display:block;width:180px;margin:4px 0;padding:8px;background:#303;border:2px solid #555;border-radius:8px;color:#fff;cursor:pointer;}
input{width:60px;padding:4px;margin-right:6px;border-radius:4px;border:1px solid #555;background:#111;color:#fff;}
#pcmButtons{margin-top:10px;}
</style>
</head>
<body>
<h1>Volume Control</h1>
<div class="section">
  <h1>üîä Volume</h1>
  <button class="btn" onclick="volumeUp()">Volume Up</button>
  <button class="btn" onclick="volumeDown()">Volume Down</button>
  <button class="btn" onclick="toggleMute()">Mute</button>
  <div style="display:flex;align-items:center;margin-top:4px;">
    <input type="number" id="volumeInput" placeholder="Set volume" style="flex:1;margin-right:4px;" value="10">
    <button class="btn" style="flex:0 0 auto;" onclick="setVolumeFromInput()">Set</button>
  </div>
</div>

<h1>üéõÔ∏è PCM Sounds</h1>
<button class="btn" id="pcmBtn">PCM Sounds</button>

<div class="dialog" id="pcmDialog">
  <h2>PCM Sounds</h2>
  <div id="pcmButtons"></div>
  <div class="close-btn" onclick="closeDialog('pcmDialog')">‚úï Close</div>
</div>

<script>
let currentVolume=10,isMuted=false;

// ----- Volume controls -----
function log(m){console.log('['+new Date().toLocaleTimeString()+'] '+m);}
function volumeUp(){currentVolume++;setVolume(currentVolume);}
function volumeDown(){currentVolume--;setVolume(currentVolume);}
function toggleMute(){isMuted=!isMuted;sendReq('ssap://audio/setMute',{mute:isMuted});log('Mute '+isMuted);}
function setVolume(v){currentVolume=v;sendReq('ssap://audio/setVolume',{volume:currentVolume});log('Volume '+currentVolume);}
function setVolumeFromInput(){const v=parseInt(document.getElementById('volumeInput').value,10);if(!isNaN(v))setVolume(v);}

// ----- PCM Sounds -----
const pcmSounds=[
  {label:'Power On',name:'power-on'},
  {label:'Power Off',name:'power-off'},
  {label:'Welcome',name:'welcome'},
  {label:'FU Fail',name:'first-use-fail'},
  {label:'FU Success',name:'first-use-success'},
  {label:'Input Detected',name:'input-detected'},
  {label:'Voice Start',name:'voicestart'},
  {label:'Voice Confirm',name:'voiceconfirm'},
  {label:'Voice Cancel',name:'voicecancel'},
  {label:'Loading',name:'loading'}
];

document.getElementById('pcmBtn').onclick=()=>{
  const container=document.getElementById('pcmButtons');container.innerHTML='';
  pcmSounds.forEach(s=>{
    const b=document.createElement('button');b.className='btn';b.textContent=s.label;
    b.onclick=()=>sendReq('ssap://com.webos.audio/systemsounds/playFeedback',{play:true,sink:'pfeedback',name:s.name});
    container.appendChild(b);
  });
  document.getElementById('pcmDialog').style.display='block';
};

// ----- Dialog close -----
function closeDialog(id){document.getElementById(id).style.display='none';}
</script></body></html>
