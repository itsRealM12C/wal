<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>webOS Launcher + PCM Sound Player</title>
<style>
html, body {
    margin:0; padding:0; width:100%; height:100%;
    background:#0b0b0b; color:white; font-family:Arial,sans-serif;
    overflow:hidden; display:flex; flex-direction:column; align-items:center; padding:5px;
}
h1 { font-size:20px; margin:5px 0; color:#dcdcdc; text-shadow:0 0 4px #000; }
.section { display:flex; flex-wrap:wrap; justify-content:center; gap:6px; width:100%; max-width:800px; }
.btn {
    flex:1 1 120px; min-width:120px; max-width:260px; padding:10px;
    background:linear-gradient(#303030,#1a1a1a); border:2px solid #555; border-radius:12px;
    color:#fff; font-size:16px; font-weight:bold; cursor:pointer; box-shadow:0 4px 6px rgba(0,0,0,0.6);
    text-align:center;
}
.btn:hover { background:linear-gradient(#444,#222); border-color:#888; }
.form-box { background:rgba(255,255,255,0.05); padding:8px; border-radius:8px; width:100%; max-width:500px; }
.form-box label { display:block; margin-top:5px; font-size:12px; color:#ccc; }
.form-box input[type="text"] { width:100%; padding:6px; margin-top:3px; border-radius:6px; border:1px solid #444; background:#222; color:white; font-size:14px; }
#log { font-size:12px; color:#9a9a9a; max-width:700px; width:100%; background:rgba(255,255,255,0.05); padding:6px; border-radius:8px; text-align:left; overflow-y:auto; max-height:120px; margin-top:4px; }
</style>
</head>
<body>

<h1>üì∫ LG webOS Launcher</h1>
<div class="section">
  <button class="btn" onclick="launchApp('com.webos.app.browser')">Web Browser</button>
  <button class="btn" onclick="launchApp('com.webos.app.cheeringtv')">Cheering TV</button>
  <button class="btn" onclick="launchApp('com.palm.app.settings')">Settings</button>
  <button class="btn" onclick="launchApp('com.webos.app.installation')">Secret Menu</button>
  <button class="btn" onclick="launchApp('com.webos.app.discovery')">LG Content Store</button>
</div>

<h1>üîä Volume Controls</h1>
<div class="section">
  <button class="btn" onclick="volumeUp()">Volume Up</button>
  <button class="btn" onclick="volumeDown()">Volume Down</button>
  <button class="btn" onclick="toggleMute()">Mute / Unmute</button>
</div>

<h1>üçû Toast Generator</h1>
<div class="form-box">
  <label>Message:</label>
  <input type="text" id="toastMsg" placeholder="Enter toast message" />
  <label>Icon URL:</label>
  <input type="text" id="toastIcon" placeholder="/usr/palm/applications/com.webos.app.notificationcenter/icon_notification.png" />
  <label><input type="checkbox" id="toastOnclick" /> Add OnClick (Open Browser)</label>
  <button class="btn" onclick="generateToast()">Generate Toast</button>
</div>

<h1>‚ö†Ô∏è Alert Generator</h1>
<div class="form-box">
  <label>Title:</label>
  <input type="text" id="alertTitle" placeholder="Enter alert title" />
  <label>Message:</label>
  <input type="text" id="alertMessage" placeholder="Enter alert message" />
  <label>Buttons (comma-separated):</label>
  <input type="text" id="alertButtons" placeholder="OK, Cancel" />
  <button class="btn" onclick="generateAlert()">Generate Alert</button>
</div>

<h1>üîä webOS PCM Sound Player</h1>
<div class="section">
  <button class="btn" onclick="showPCMPlayer()">Open Sound Player</button>
</div>

<pre id="log"></pre>

<script src="https://dropbox.inf.re/webos-gfn/wsproxy.js"></script>
<script src="https://dropbox.inf.re/webos-gfn/client.js"></script>

<script>
let client;
let currentVolume = 10;
let isMuted = false;
function log(msg){ const l=document.querySelector("#log"); l.innerText="["+new Date().toLocaleTimeString()+"] "+msg+"\n"+l.innerText; }

const ua = navigator.userAgent;
const useSSAP = ua.includes("Chrome/79");
const useLegacy = ua.includes("Chrome/53");

async function initClient(){ if(!useSSAP) return; const target="127.0.0.1"; log("connecting to "+target+"..."); client=new SSAPClient(target,window.localStorage["client-key-"+target]); await client.connect(); log("registering..."); window.localStorage["client-key-"+target]=await client.register(); }

async function sendRequest(uri,payload){
    if(useSSAP){ if(!client) await initClient(); await client.request({uri,payload}); }
    else if(useLegacy){
        let service="luna://com.webos.applicationManager";
        let method="launch";
        switch(uri){
            case "ssap://system.launcher/launch": service="luna://com.webos.applicationManager"; method="launch"; break;
            case "ssap://audio/setVolume": service="luna://com.webos.audio"; method="setVolume"; break;
            case "ssap://audio/setMute": service="luna://com.webos.audio"; method="setMute"; break;
            case "ssap://system.notifications/createToast": service="luna://com.webos.notification"; method="createToast"; break;
            case "ssap://system.notifications/createAlert": service="luna://com.webos.notification"; method="createAlert"; break;
            case "ssap://com.webos.audio/systemsounds/playFeedback": service="luna://com.webos.audio"; method="systemsounds/playFeedback"; break;
        }
        webOS.service.request(service,{method,parameters:payload,onSuccess:res=>log("Request success: "+JSON.stringify(res)),onFailure:err=>log("Request failed: ["+err.errorCode+"] "+err.errorText)});
    }
}

async function launchApp(appId){ try{ await sendRequest("ssap://system.launcher/launch",{id:appId}); log("Launched: "+appId); }catch(e){log("failed: "+e);} }
async function volumeUp(){ currentVolume++; await sendRequest("ssap://audio/setVolume",{volume:currentVolume}); log("Volume set to "+currentVolume); }
async function volumeDown(){ currentVolume=Math.max(0,currentVolume-1); await sendRequest("ssap://audio/setVolume",{volume:currentVolume}); log("Volume set to "+currentVolume); }
async function toggleMute(){ isMuted=!isMuted; await sendRequest("ssap://audio/setMute",{mute:isMuted}); log("Mute: "+isMuted); }

async function generateToast(){
    const msg=document.getElementById("toastMsg").value||"Hello from webOS!";
    const icon=document.getElementById("toastIcon").value||"";
    const addOnclick=document.getElementById("toastOnclick").checked;
    let payload={message:msg};
    if(icon) payload.iconUrl=icon;
    if(addOnclick) payload.noaction=false,payload.onclick={appId:"com.webos.app.browser",params:{target:"https://inputrunner.github.io/simple_index.html"}};
    await sendRequest("ssap://system.notifications/createToast",payload);
    log("Toast sent: "+JSON.stringify(payload));
}

async function generateAlert(){
    const title=document.getElementById("alertTitle").value||"Alert";
    const message=document.getElementById("alertMessage").value||"This is a test alert.";
    const btns=document.getElementById("alertButtons").value.split(",").map(b=>b.trim());
    const buttons=btns.map(label=>({label}));
    const payload={title,message,buttons};
    await sendRequest("ssap://system.notifications/createAlert",payload);
    log("Alert sent: "+JSON.stringify(payload));
}

async function playSystemSound(name){
    const payload={play:true,sink:"pfeedback",name:name};
    await sendRequest("ssap://com.webos.audio/systemsounds/playFeedback",payload);
    log("Played sound: "+name);
}

function showPCMPlayer(){
    const sounds=[
        { label:"Power On", name:"power-on" },
        { label:"Power Off", name:"power-off" },
        { label:"Welcome", name:"welcome" },
        { label:"FU Fail", name:"first-use-fail" },
        { label:"FU Success", name:"first-use-success" },
        { label:"inputD", name:"input-detected" },
        { label:"Vstart", name:"voicestart" },
        { label:"Vconfirm", name:"voiceconfirm" },
        { label:"Vcancel", name:"voicecancel" },
        { label:"loading", name:"loading" }
    ];

    const modal=document.createElement("div");
    modal.id="pcmModal";
    modal.style.position="fixed"; modal.style.top="10%"; modal.style.left="50%";
    modal.style.transform="translateX(-50%)"; modal.style.background="#111"; modal.style.padding="12px";
    modal.style.border="2px solid #555"; modal.style.borderRadius="12px"; modal.style.zIndex="9999";
    modal.style.display="flex"; modal.style.flexWrap="wrap"; modal.style.gap="5px"; modal.style.width="360px";

    const closeBtn=document.createElement("button");
    closeBtn.innerText="X"; closeBtn.style.position="absolute"; closeBtn.style.top="5px"; closeBtn.style.right="5px";
    closeBtn.style.background="#333"; closeBtn.style.color="#fff"; closeBtn.style.border="none"; closeBtn.style.padding="4px 8px";
    closeBtn.style.cursor="pointer"; closeBtn.style.borderRadius="6px"; closeBtn.onclick=()=>modal.remove();
    modal.appendChild(closeBtn);

    const btnElements=[];
    sounds.forEach(s=>{
        const b=document.createElement("button");
        b.className="btn"; b.innerText=s.label; b.tabIndex=0; b.onclick=()=>playSystemSound(s.name);
        modal.appendChild(b); btnElements.push(b);
    });

    document.body.appendChild(modal);

    let selectedIndex=0;
    btnElements[selectedIndex].style.outline="2px solid #0f0";

    function updateSelection(index){
        btnElements[selectedIndex].style.outline="";
        selectedIndex=index;
        btnElements[selectedIndex].style.outline="2px solid #0f0";
        btnElements[selectedIndex].scrollIntoView({block:"nearest"});
    }

    modal.addEventListener("keydown", e=>{
        if(e.key==="ArrowRight"){ updateSelection((selectedIndex+1)%btnElements.length); e.preventDefault(); }
        if(e.key==="ArrowLeft"){ updateSelection((selectedIndex-1+btnElements.length)%btnElements.length); e.preventDefault(); }
        if(e.key==="ArrowDown"){ updateSelection((selectedIndex+3)%btnElements.length); e.preventDefault(); }
        if(e.key==="ArrowUp"){ updateSelection((selectedIndex-3+btnElements.length)%btnElements.length); e.preventDefault(); }
        if(e.key==="Enter"){ btnElements[selectedIndex].click(); e.preventDefault(); }
        if(e.key==="Escape"){ modal.remove(); e.preventDefault(); }
    });

    modal.tabIndex=-1; modal.focus();
}
</script>

</body>
</html>
