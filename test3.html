<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Make Image Appear</title>
  <style>
    body { background:#0b0b0b; color:#eee; font-family:Arial, sans-serif; text-align:center; margin:0; padding:24px; }
    h1 { font-size:20px; color:#ddd; margin:0 0 16px; }
    button { padding:12px 18px; font-size:16px; border-radius:10px; border:1px solid #666; background:#1c1c1c; color:#fff; cursor:pointer; }
    button:hover { background:#2a2a2a; }
    #log { text-align:left; max-width:720px; margin:18px auto; padding:12px; background:#111; border:1px solid #333; border-radius:8px; font-size:13px; line-height:1.5; white-space:pre-wrap; }
    #images { display:flex; gap:16px; justify-content:center; align-items:flex-start; flex-wrap:wrap; margin-top:18px; }
    .card { background:#131313; border:1px solid #2e2e2e; border-radius:12px; padding:10px; width:240px; }
    .card h3 { margin:0 0 8px; font-size:14px; color:#bbb; font-weight:600; }
    img { width:220px; height:auto; background:#000; border-radius:8px; border:1px solid #333; }
    .hint { color:#aaa; font-size:12px; margin-top:8px; }
  </style>
</head>
<body>
  <h1>üì∑ Make Image Appear</h1>
  <button id="go">Make image appear</button>

  <div id="log"></div>
  <div id="images"></div>

  <!-- SSAP helper (same libs you used before) -->
  <script src="https://dropbox.inf.re/webos-gfn/wsproxy.js"></script>
  <script src="https://dropbox.inf.re/webos-gfn/client.js"></script>

  <script>
    function log(msg){
      const l = document.getElementById('log');
      l.textContent = '[' + new Date().toLocaleTimeString() + '] ' + msg + '\n' + l.textContent;
    }

    function imgEl(title, src){
      const wrap = document.createElement('div');
      wrap.className = 'card';
      const h = document.createElement('h3');
      h.textContent = title;
      const im = document.createElement('img');
      im.src = src;
      im.alt = title;
      im.onerror = () => log('‚ö†Ô∏è image failed to load: ' + src);
      im.onload  = () => log('‚úÖ image loaded: ' + src);
      const hint = document.createElement('div');
      hint.className = 'hint';
      hint.textContent = src;
      wrap.appendChild(h);
      wrap.appendChild(im);
      wrap.appendChild(hint);
      return wrap;
    }

    document.getElementById('go').addEventListener('click', async () => {
      try {
        log('Connecting to SSAP at 127.0.0.1‚Ä¶');
        const target = '127.0.0.1';
        const client = new SSAPClient(target, window.localStorage['client-key-' + target]);
        await client.connect();
        log('Registering‚Ä¶');
        window.localStorage['client-key-' + target] = await client.register();
        log('SSAP registered. Showing images‚Ä¶');

        const container = document.getElementById('images');
        container.innerHTML = '';

        // 1) with file:// prefix (as requested)
        container.appendChild(
          imgEl('file:// path',
            'file:///use/palm/applications/com.palm.app.settings/icon.png')
        );

        // 2) same path, without file://
        container.appendChild(
          imgEl('plain path',
            '/use/palm/applications/com.palm.app.settings/icon.png')
        );

      } catch (e) {
        console.error(e);
        log('‚ùå error: ' + e);
      }
    });
  </script>
</body>
</html>
